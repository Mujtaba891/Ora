<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ora-Editor</title>
    <link rel="stylesheet" href="style.css">
    <link rel="icon" href="/WhatsApp Image 2025-02-17 at 18.49.38_59237ca1.png">
    <link rel="manifest" href="manifest.json">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
</head>
<body>

    <div class="editor-container">
        <div class="editor-header">
        <div class="tool-kit">
            <div class="logo">
                <a href="index.html"><img src="/WhatsApp Image 2025-02-17 at 18.49.38_59237ca1.png" alt="Logo" width="60px"></a>
                
            </div>
        <div class="toolbar">
            <button><a href="index.html"><i class="fas fa-home"></i>
            </a></button>
            <!--<div class="actions">
                <button id="saveButton">Save</button>
            </div>-->
            <button onclick="saveFile()"><i class="fas fa-save"></i>
            </button> 
            <button onclick="downloadOraFile()"><i class="fas fa-download"></i></button>
            <button id="openOraFileButton">
                <i class="fas fa-folder-open"></i>
            </button>
            <input type="file" id="fileInput" accept=".Ora" style="display: none;">
            
        </div>
    </div>
      
        
    </div>
        <div class="workspace">
            <div class="sidebar" id="sidebar">
                <div class="input-btn">
                     <input type="file" id="uploadMedia" accept="image/*,video/*" onchange="addMedia(event)" hidden>
                     <label for="uploadMedia" class="upload-icon">
                        <i class="fas fa-upload"></i> <!-- Yeh icon emoji hai, niche CSS me FontAwesome ka bhi option diya hai -->
                    </label>
                </div>
                

                <h3>Media</h3>
                <div id="mediaContainer"></div>
            </div>
            <div class="content">
                
                <div class="format-toolbar">
                    <button onclick="formatText('bold')"><i class="fas fa-bold"></i></button>
                    <button onclick="formatText('italic')"><i class="fas fa-italic"></i></button>
                    <button onclick="formatText('underline')"><i class="fas fa-underline"></i></button>
                    <button onclick="toggleCase()"><i class="fas fa-text-height"></i></button>
                    
                    <input type="color" id="textColorPicker" onchange="changeTextColor(this.value)">
                   <!-- Heading Selection Dropdown -->
                   <select onchange="formatText('heading', this.value)">
                    <option value="p">Paragraph</option>
                    <option value="h3">Heading 3</option>
                    <option value="h2">Heading 2</option>
                    <option value="h1">Heading 1</option>
                </select>
                
                    <select onchange="formatText('fontsize', this.value)">
                        <!-- 0px se 24px tak ke options -->
                        <option value="1px">1px</option>
                        <option value="2px">2px</option>
                        <option value="3px">3px</option>
                        <option value="4px">4px</option>
                        <option value="5px" >5px</option>
                        <option value="6px">6px</option>
                        <option value="7px">7px</option>
                        <option value="8px">8px</option>
                        <option value="9px">9px</option>
                        <option value="10px">10px</option>
                        <option value="12px">12px</option>
                        <option value="14px">14px</option>
                        <option value="16px" selected>16px</option>
                        <option value="18px">18px</option>
                        <option value="20px">20px</option>
                        <option value="22px">22px</option>
                        <option value="24px">24px</option>
                    </select>
                    <select onchange="formatText('fontname', this.value)">
                        <option value="Arial">Arial</option>
                        <option value="Verdana">Verdana</option>
                        <option value="Times New Roman">Times New Roman</option>
                        <option value="Courier New">Courier New</option>
                        <option value="Georgia">Georgia</option>
                        <option value="Tahoma">Tahoma</option>
                        <option value="Trebuchet MS">Trebuchet MS</option>
                        <option value="Impact">Impact</option>
                        <option value="Comic Sans MS">Comic Sans MS</option>
                        <option value="Lucida Sans">Lucida Sans</option>
                        <option value="Palatino Linotype">Palatino Linotype</option>
                        <option value="Garamond">Garamond</option>
                        <option value="Bookman Old Style">Bookman Old Style</option>
                        <option value="Arial Black">Arial Black</option>
                        <option value="Century Gothic">Century Gothic</option>
                        <option value="Franklin Gothic Medium">Franklin Gothic Medium</option>
                        <option value="Calibri">Calibri</option>
                        <option value="Cambria">Cambria</option>
                        <option value="Futura">Futura</option>
                        <option value="Geneva">Geneva</option>
                        <option value="Rockwell">Rockwell</option>
                        <option value="Monaco">Monaco</option>
                        <option value="Copperplate">Copperplate</option>
                        <option value="Brush Script MT">Brush Script MT</option>
                        <option value="Baskerville">Baskerville</option>
                        <option value="Didot">Didot</option>
                        <option value="Lucida Console">Lucida Console</option>
                        <option value="Perpetua">Perpetua</option>
                        <option value="MS Sans Serif">MS Sans Serif</option>
                        <option value="MS Serif">MS Serif</option>
                        <option value="Gill Sans">Gill Sans</option>
                        <option value="Segoe UI">Segoe UI</option>
                        <option value="Optima">Optima</option>
                        <option value="Goudy Old Style">Goudy Old Style</option>
                        <option value="Charcoal">Charcoal</option>
                        <option value="Zapf Chancery">Zapf Chancery</option>
                        <option value="Serif">Serif</option>
                        <option value="Sans-serif">Sans-serif</option>
                        <option value="Fantasy">Fantasy</option>
                        <option value="Cursive">Cursive</option>
                        <option value="Algerian">Algerian</option>
                        <option value="Berlin Sans FB">Berlin Sans FB</option>
                        <option value="Broadway">Broadway</option>
                        <option value="Castellar">Castellar</option>
                        <option value="Century Schoolbook">Century Schoolbook</option>
                        <option value="Engravers MT">Engravers MT</option>
                        <option value="Eras Bold ITC">Eras Bold ITC</option>
                        <option value="Footlight MT Light">Footlight MT Light</option>
                        <option value="Harrington">Harrington</option>
                        <option value="Jokerman">Jokerman</option>
                        <option value="Kristen ITC">Kristen ITC</option>
                        <option value="Magneto">Magneto</option>
                        <option value="Matura MT Script Capitals">Matura MT Script Capitals</option>
                        <option value="Old English Text MT">Old English Text MT</option>
                        <option value="Papyrus">Papyrus</option>
                        <option value="Playbill">Playbill</option>
                        <option value="Ravie">Ravie</option>
                        <option value="Showcard Gothic">Showcard Gothic</option>
                        <option value="Snap ITC">Snap ITC</option>
                        <option value="Stencil">Stencil</option>
                        <option value="Viner Hand ITC">Viner Hand ITC</option>
                        <option value="Vivaldi">Vivaldi</option>
                        <option value="Vladimir Script">Vladimir Script</option>
                    </select>
                    
                    <!-- Text Align Buttons -->
            <button onclick="formatText('justifyLeft')"><i class="fas fa-align-left"></i></button>
            <button onclick="formatText('justifyCenter')"><i class="fas fa-align-center"></i></button>
            <button onclick="formatText('justifyRight')"><i class="fas fa-align-right"></i></button>
                </div>
                <div class="editor" id="editor" contenteditable="true"></div>
           
            </div>
        </div>
    </div>
    <script src="script.js"></script>
    <script src="app.js"></script>
    <script>
        if ('serviceWorker' in navigator) {
            navigator.serviceWorker.register('service-worker.js')
                .then(() => console.log("Service Worker Registered"));
        }

    </script>
    <script>
  document.addEventListener("DOMContentLoaded", function () {
    const saveButton = document.getElementById("saveButton");
    const editor = document.getElementById("editor");

    if (!saveButton) {
        console.error("Save button not found!");
        return;
    }

    if (!editor) {
        console.error("Editor not found!");
        return;
    }

    saveButton.addEventListener("click", function () {
        const editorContent = editor.innerHTML;

        if (!editorContent.trim()) {
            alert("Cannot save an empty file!");
            return;
        }

        let fileName = prompt("Enter file name:");
        if (!fileName) return; // If user cancels, do nothing

        // Store file in localStorage
        let savedFiles = JSON.parse(localStorage.getItem("savedFiles")) || {};
        savedFiles[fileName] = editorContent;
        localStorage.setItem("savedFiles", JSON.stringify(savedFiles));

        // Add to recents
        let recents = JSON.parse(localStorage.getItem("recents")) || [];
        if (!recents.includes(fileName)) recents.push(fileName);
        localStorage.setItem("recents", JSON.stringify(recents));

        // Redirect to home page
        window.location.href = "index.html";
    });
});



function saveFile() {
        let fileName = localStorage.getItem("currentFile") || prompt("Enter file name:");
        if (!fileName) return; 

        const editorContent = document.getElementById("editor").innerHTML; 

        let savedFiles = JSON.parse(localStorage.getItem("savedFiles")) || {};
        savedFiles[fileName] = editorContent; 
        localStorage.setItem("savedFiles", JSON.stringify(savedFiles));

        let recents = JSON.parse(localStorage.getItem("recents")) || [];
        if (!recents.includes(fileName)) recents.push(fileName);
        localStorage.setItem("recents", JSON.stringify(recents));

        alert("File saved successfully!");
        window.location.href = "index.html"; 
    }

   /* window.onload = function () {
        const fileContent = localStorage.getItem("currentContent");
        if (fileContent) {
            document.getElementById("editor").innerHTML = fileContent;
        }
    };*/

  
   // Load File Content in Editor When Page Opens
   window.onload = function () {
    const params = new URLSearchParams(window.location.search);
    const fileName = params.get("file");

    if (!fileName) {
        console.log("No file selected.");
        return;
    }

    console.log("Opening file:", fileName);
    // Try getting from sessionStorage (for recent edits)
    let fileContent = sessionStorage.getItem("currentFileContent");

    // If not in sessionStorage, check localStorage
    if (!fileContent) {
        const savedFiles = JSON.parse(localStorage.getItem("savedFiles")) || {};
        fileContent = savedFiles[fileName];
    }

    console.log("Loaded file content:", fileContent);

    // Find editor element
    const editor = document.getElementById("editor");
    console.log("Editor element:", editor);

    if (editor && fileContent) {
        editor.innerHTML = fileContent; // Set content if editor exists
    } else {
        console.log("File not found in storage or editor not found.");
    

    if (fileContent) {
        document.getElementById("editor").innerHTML = fileContent; // For contenteditable div
    } else {
        console.log("File not found in storage.");
    }
}};


async function loadFileFromParams() {
    const params = new URLSearchParams(window.location.search);
    const fileName = params.get("file");

    if (!fileName) {
        console.error("No file specified");
        return;
    }

    // ðŸ”¹ LocalStorage se file content nikalna
    const savedFiles = JSON.parse(localStorage.getItem("savedFiles")) || {};
    const fileContent = savedFiles[fileName];

    if (!fileContent) {
        console.error("File not found in localStorage");
        alert("File not found!");
        return;
    }

    // ðŸŸ¢ File content editor me load karna
    document.getElementById("editor").innerHTML = fileContent;
}

// ðŸŸ¢ Page load hone par function call hoga
window.onload = loadFileFromParams;

console.log("Loaded file content:", fileContent);
console.log("Editor element:", document.getElementById("editor"));

    </script>
</body>
</html>